= Asciidoctor 0.1.4 Changelog
Sarah White
:issue-ref: https://github.com/asciidoctor/asciidoctor/issues
:awestruct-draft: true

.TODO
====
* Incorporate Release Notes Template in Docs repo
* Answer the TODOs interspersed through document, TODOs are in bold or in comment sections
* Review and delete all comments
* If possible, comment out information/documentation not needed for the release notes but specify what document it should be moved to
====

== ADDME

* Extension API
* xref inline macro supports inter-document references (#417)
* XML comment-style callouts for use in XML listings (#582)
* include file relative to current file in include stack (#572)
* handle callout marks properly when using server-side syntax highlighting (#534)
* added support for external video hosting services in video block macro (@xcoulon) (#587)
* Debian package

---

== Classy code listings

We know how important code is to you.
It's important to us too.
That's why we made sure code listings received some nice refinements in this release.
Adding source code to documentation has never been so easy, and rewarding!

=== Callouts don't get caught in copy

Previously, when a reader visiting an HTML page generated by Asciidoctor would select source code from a listing that contains callouts and copy it, the callout numbers would get caught up in the copy.
If the reader pasted that code and tried to run it, likely the extra characters from the callouts caused compile or runtime errors.
Readers shouldn't have to understand why the documentation is putting extra characters in the clipboard.
Copy and paste should just work.

In this release, we used some CSS ninja moves to prevent the callouts from being selected.
No matter how hard the reader tries (or how little they understand about the problem), those callouts just won't get selected.

On the other side of the coin, you don't want the callout annotations messing up your source code either.
We can't play fancy CSS games in raw source code, but we can leverage line comments!
You can now tuck your callouts neatly inside line comments.
Asciidoctor will recognize the line comments characters in front of a callout number, optionally offset by a space, and remove them when rendering the document.

Here are the line comments that are supported:

[source,asciidoc]
....
----
line of code  // \<1>
line of code   # \<2>
line of code  ;; \<3>
----
<1> A callout behind a line comment for C-style languages.
<2> A callout behind a line comment for Ruby, Python, Perl, etc.
<3> A callout behind a line comment for Clojure.
....

Here's how it looks when rendered:

----
line of code  // <1>
line of code  # <2>
line of code  ;; <3>
----
<1> A callout behind a line comment for C-style languages.
<2> A callout behind a line comment for Ruby, Python, Perl, etc.
<3> A callout behind a line comment for Clojure.

WARNING: Asciidoctor enforces that callouts be placed at the end of the line.

The focus is to ensure callouts are an aid, not a pain.
Speaking of pain, what about callouts in XML?
Read on to find out.

_Resolves issue {issue-ref}/478[#478]._

=== XML-friendly callouts

XML doesn't have line comments, so our "tuck the callout behind a line comment" trick doesn't work here.
We played around with the syntax and came up with something we think works, and looks, rather nice.
All we have to do is stretch out the angled brackets around the callout number so the callout itself becomes an XML comment.

`<1>` => `<!--1-->`

Here's how it appears in a listing:

[source,asciidoc]
....
[source.xml]
----
<section>
  <title>Section Title</title>  \<!--1-->
</section>
----
<1> The section title is required.
....

Here's how it looks when rendered:

[source,xml]
----
<section>
  <title>Section Title</title>  <!--1-->
</section>
----
<1> The section title is required.

Notice the comment is gone.
Now both you and the reader can copy and paste source code containing callouts to your heart's content and no errors will hitch a ride.

_Resolves issue {issue-ref}/582[#582]._

=== Callouts, no highlight for you!

Our tricks with callouts aren't quite over yet.
We had reports that callouts weren't getting replaced in some cases when the CodeRay source highlighter was used (e.g., +source-highlighter=coderay+).

It turns out, the problem is that the very precense of the callouts in the code, whether behind line comments or not, causes them to get caught up in the highlighting and mangled.
The trick here is to pull the callouts out of the source code before highlighting, then restore them after highlighting is done.
That way, the source highlighter never sees them, and we can be sure that they end up where they're supposed to be, unmangled.

There's nothing you need to change to take advantage of this improvement.
It just works when using CodeRay or Pygments.

_Resolves issue {issue-ref}/534[#534]._

``Did you say Pygments?''
That's right, Asciidoctor now allows you to use Pygments for source code highlighting.

=== Syntax highlighting with Pygments

The most popular source code highlighter in the AsciiDoc world, perhaps even the whole world, is http://pygments.org[Pygments].
Until now, Asciidoctor only integrated with CodeRay for "server-side" source highlighting, mostly because it's also written in Ruby.

Thanks to the awesome folks at GitHub, Pygments now has a nice Ruby wrapper library named https://github.com/tmm1/pygments.rb[pygments.rb] that makes integrating with it a cinch.
So I figured, why not?

In order to use Pygments with Asciidoctor, you need to install Pygments (and Python, if you don't have it yet).
You then need to install the pygments.rb RubyGem.
Something like:

 $ "`\which apt-get || \which yum || \which brew`" install pygments
 $ gem install pygments.rb

To activate it in Asciidoctor, assign the value +pygments+ to the +source-highlighter+ attribute in your document's header.

 :source-highlighter: pygments

Voila!
You've not got "pygments" in your code.

// TODO: We may also need to ship a default stylesheet to be embedded or copied to the output directory. Was this done?
// nope, not yet...I did some tweaking to get it looking reasonable, but the themes for Pygments are as ugly as sin

_Resolves issue {issue-ref}/538[#538]._

We've also made some improvements to the CodeRay stylesheet and how it gets incorporated into your HTML output.

=== +REVIEW+ If +linkcss+ is not set, the CodeRay stylesheet will be embedded

The CodeRay stylesheet is embedded in a document only when the +linkcss+ attribute is *not* set.
If +linkcss+ is set, the CodeRay stylesheet or a user specified alternative coderay.css stylesheet will be linked to the document.
The +copycss+ attribute also copies the CodeRay stylesheet to coderay.css next to the default Asciidoctor stylesheet.

Resolves {issue-ref}/381[381]

*TODO: Might combine this update with the update regarding the stylesheet default setting change*

=== +REVIEW+ improved the built-in CodeRay theme to match Asciidoctor styles

write me

=== +REVIEW+ Pre-wrap literal blocks and nowrap option

Stylesheets should support pre-wrap and word-wrap: break-word;

Currently, the AsciiDoctor style is configured to respect pre-formatted lines and prevent any word wrapping. This is fine in theory, however in practice it frequently means that content overflows the browser window and causes scrolling, which is a far greater readability problem than wrapping.

There are two camps on this preference and neither setting will please both. That points to making this an option. The default of no-wrap complies with the behavior of AsciiDoc (which attempt to mimic for credibility). However, I definitely want to accommodate this preference / use case.

The most obvious and AsciiDoc-like way to provide this customization is to add an "option" for wrapping (in the same way that options are used to set strong text, compact list items, etc).

[source, java, options="wrap"]
----
public class ApplicationConfigurationProvider extends HttpConfigurationProvider
{
   @Override
   public Configuration getConfiguration(ServletContext context)
   {
      return ConfigurationBuilder.begin()
               .addRule()
               .when(Direction.isInbound().and(Path.matches("/{path}")))
               .perform(Log.message(Level.INFO, "Client requested path: {path}"))
               .where("path").matches(".*");
   }
}
----

With Asciidoctor, the options can be abbreviated as:

[source, java, opts=wrap]
Since this is a setting you likely want to apply globally, I'm considering an attribute such as:

:prewrap:

I realized that the behavior of AsciiDoc is the opposite, pre-wrap is used by default. Therefore, we'll make that the default in Asciidoctor and require options="nowrap" (or role="nowrap") for the nowrap class to be added. Specifying this option will output:

<pre class="nowrap">

in addition to any other class that is emitted.

Excellent, don't forget that break-word is also required for this to function properly!

Yep, I added both. I think it make sense to use them as a pair, hence the
attribute only refers to "wrap" in a general sense (i.e., just do the right
thing)

Resolves {issue-ref}/303[303]

== Mark your lists

...move all list stuff to here...



== New features and enhancements

=== Getting Things Done using AsciiDoc checklists

If you use AsciiDoc to track the completion of tasks, get ready to start checking things off your list!
List items in AsciiDoc can now be marked complete using checklists.

Checklists (i.e., task lists) are unordered lists that have items marked as checked (+[*]+ or +[x]+) or unchecked (+[ ]+).
Here's an example:

.Checklist
----
- [*] checked
- [x] also checked
- [ ] not checked
-     normal list item
----

TIP: Not all items in the list have to be checklist items, as the previous example shows.

When checklists are rendered to HTML, the checkbox markup is transformed into an HTML checkbox with the appropriate checked state.
The +data-item-complete+ attribute on the checkbox is set to 1 if the item is checked, 0 if not.
The checkbox is used in place of the item's bullet.

Since HTML generated from AsciiDoc is usually static, the checkbox is set as disabled to make it appear as a simple mark.
If you want to make the checkbox interactive (i.e., clickable), add the +interactive+ option to the checklist:

.Checklist with interactive checkboxes
----
[options=interactive]
- [*] checked
- [x] also checked
- [ ] not checked
-     normal list item
----

As a bonus, if you enable font-based icons, the checkbox markup (in non-interactive lists) is transformed into a font-based icon!

.Checklist with font-based checkboxes
----
:icons: font

- [*] checked
- [x] also checked
- [ ] not checked
-     normal list item
----

_Resolves issue {issue-ref}/200[#200]._

=== Process multiple source files from the CLI

The Asciidoctor CLI (i.e., the +asciidoctor+ command) is no longer single-minded!
You can pass multiple source files (or a file name pattern) to the Asciidoctor CLI and it will process all the files in turn.

Let's assume there are two AsciiDoc files in your directory, [file]#a.adoc# and [file]#b.adoc#.
When you enter the following command in your terminal:

 $ asciidoctor a.adoc b.adoc

Asciidoctor will process both files, transforming [file]#a.adoc# to [file]#a.html# and [file]#b.adoc# to [file]#b.html#.

To save you some typing, you can use the glob operator (+*+) to match both files using a single argument:

 $ asciidoctor *.adoc

The shell will expand the previous command to the one you typed earlier:

 $ asciidoctor a.adoc b.adoc

You can also render all the AsciiDoc files in immediate subfolders using the double glob operator (+**+) in place of the directory name:

 $ asciidoctor **/*.adoc

To match all files in the current directory and immediate subfolders, use both glob patterns:

 $ asciidoctor *.adoc **/*.adoc

If the file name argument is quoted, the shell will not expand it:

 $ asciidoctor '*.adoc'

This time, the text +*.adoc+ gets passed directly to Asciidoctor instead of being expanded to [file]#a.adoc# and [file]#b.adoc#.
In this case, Asciidoctor handles the glob matching internally in the same way the shell does (when the file name is not in quotes)--with one exception.
Asciidoctor can match files in the current directory and subfolders at any depth using a single glob pattern:

 $ asciidoctor '**/*.adoc'

Now that's saving you some typing!

_Resolves issue {issue-ref}/227[#227]._

=== +REVIEW+ Specify multiple custom template directories

Custom templates no longer need to be stored in the same directory.
Now, you can build on another custom backend without copying its templates into a new directory. 
Just specify the template directory of the original backend, followed by the template directory containing your overrides and customizations.

In the CLI, multiple directories are supplied using the +-T+ option multiple times (thus, there is no need for a +--template-dirs+ argument).

*TODO: Commandline example showing how to use +-T+ as well as any common commands that are typically used with it and caveats (i.e. you can't also use +template_engine+*

Resolves {issue-ref}/437[437]

////

The template_dir option in the API should accommodate an array of strings in addition to a string value. 

1. Does the template engine stuff need to be included?

NOTE: When multiple template directories are specified, the +template_engine+ option no longer applies (mutually exclusive).  

As it turns out, we don't have to forbid the use of template_engine when using multiple template directories. 
Asciidoctor will just look for a folder matching the template engine in each template directory (the same logic that's applied when only one template directory is provided).

2. Does the information Alex provided need to be included in documentation somewhere and/or in this changelog?

@lordofthejars Note that this is a change to the options. Asciidoctor first looks for :template_dir and, if present, wraps it in an array and assigns it to :template_dirs. If :template_dir is absent, Asciidoctor then looks for template_dirs and expects it to be an Array. The best approach in the fluent API is to allow templateDir to be specified multiple times, and also add a templateDirs method which appends to that running list. Then, just pass the :template_dirs to Asciidoctor.

////

////
This one needs a do over
////

=== +REVIEW+ Additional numbering styles for ordered lists

Asciidoctor supports lowergreek and decimal-leading-zero numeration for ordered lists. 
Additional numeration styles can be implemented using a custom role (i.e., style class). 

*TODO: In the code it looks like all of these styles are supported, or are some of them still custom?*

Style options are now as follows:

* arabic (equivalent to decimal)
* decimal (equivalent to decimal-leading-zero)
* loweralpha (equivalent to lower-alpha)
* upperalpha (equivalent to upper-alpha)
* lowerroman (equivalent to lower-roman)
* upperroman (equivalent to upper-roman)
* lowergreek (equivalent to lower-greek)

(the "equivalent to" refers to the value of the list-style-type CSS property)

*TODO: I don't understand what the 'equivalent to' means or if it is relevant to users/documentation?*

Arabic and decimal are aliases.
The keyword decimal refers to the decimal-leading-zero numeration style.

*TODO: Example code showing how to use one of these styles and table/list of each option's name and with sample of what it looks like*

Resolves {issue-ref}/364[364] 

=== +REVIEW+ Custom markers for unordered lists

An unordered list marker can be represented as a:

* square
* circle
* disc
* no-bullet (equivalent to none)

*TODO: Example code showing how to use one of these styles and table/list of each option's name and with sample of what it looks like*

These styles are supported by the default stylesheet.

Resolves {issue-ref}/364[364] 

=== +REVIEW+ Enable the table header row implicitly

After adding shorthand syntax for table format in Asciidoctor 0.1.3, it seemed tedious to include the +[options="header"]+ block attribute line above a table in order to enable the header row.

Asciidoctor 0.1.4 introduces the following rule set that allows the writer to enable the table header row implicitly.

. The first line of content inside the table block delimiters is non-empty.
. The second line of content inside the table block delimiters is empty.
. The options attribute has not been assigned.
. If these are all true, then enable the header option on the table.

The table header row will be enabled implicitly in the example below.

----
|===
|Col A |Col B |Col C

|Value 1
|Value 2
|Value 3

|Value 4
|Value 5
|Value 6
|===
----

.Output 
|===
|Col A |Col B |Col C

|Value 1
|Value 2
|Value 3

|Value 4
|Value 5
|Value 6
|===

*TODO: Did the method below get implemented?*

I haven't decided whether we should allow the table header row to be enabled in this scenario, because it requires a lot more forward seeking:

[rows="3"]
|===
|Col A
|Col B
|Col C

|Value 1
|Value 2
|Value 3

|Value 4
|Value 5
|Value 6
|===

Resolves {issue-ref}/387[387]

=== +REVIEW+ HTML5 backend renders multiple authors

The HTML5 backend renders multiple authors when they are separated by a semicolon (+;+).

----
= Big Document
John Henry;Jonas Flex;Ziggy Jean
----

Resolves {issue-ref}/399[399]

=== +REVIEW+ DocBook 5.0 Backend

*TODO: Command needed*
*What's different between it and the 4.5 backend that may cause confusion/problems for users?*

Resolves {issue-ref}/411[411]

=== +REVIEW+ Text enclosed in backticks supports the role assignment

Like other enclosed text in AsciiDoc, text enclosed in backticks allows a role to be assigned.

Given:

 [rolename]`escaped text`
 
The following HTML is produced:

 <code class="rolename">escaped text</code>
 
This makes the behavior of backticks consistent with other forms of enclosed text in Asciidoctor.

Resolves {issue-ref}/419[419]

=== +REVIEW+ Style attribute moved to instance variable on AbstractBlock

Style attributes apply to nearly every block, so it made sense to add them as an instance variable on AbstractBlock.

As a result of this change, templates can be simplified from:

 if (attr :style, nil, false) == 'abstract'

to:

 if @style == 'abstract'
 
AbstractNode convenience methods for +role?+, +role+, +reftext?+ and +reftext+ were also added to further simplify template creation.

*TODO: Example code showing how to use these styles and table/list of each styles's name and function*

Resolves {issue-ref}/436[436]

=== +REVIEW+ Import a file from a URI using the include macro

The include macro can import a file from a URI.

IMPORTANT: The +:allow-uri-read:+ attribute must be set in the API or CLI (not document) in order to include content form a URI.
The attribute is disabled if the safe mode is SECURE or greater.

Example:

 include::https://raw.github.com/asciidoctor/asciidoctor/master/README.adoc[]

Resolves {issue-ref}/445[445]

*TODO: Does the caching thing need to be mentioned? And if so, will need example for documentation.

Caching is strongly recommended. To enable the built-in cache:

* install the open-uri-cached gem
* pass the cache-uri attribute

=== +REVIEW+ Font Awesome ugraded

Asciidoctor uses Font Awesome 3.2.1.

Resolves {issue-ref}/451[451]

=== Markdown-style horizontal rules

Asciidoctor continues to expand support for (reasonable) Markdown syntax by recognizing Markdown horizontal rules.
The motivation here is to ease migration (both of the content and the mind).

To avoid conflicts with the syntax of AsciiDoc block delimiters, only 3 repeating characters (+-+ or +*+) are recognized.
As with Markdown, whitespace between the characters is optional.

.Recognized Markdown horizontal rule syntax
----
---

- - -

***

* * *
----

A macro definition for the Markdown horizontal rules is included in the AsciiDoc compatibility file so they can be recognized by the +asciidoc+ command as well.

_Resolves issue {issue-ref}/455[#455]._

=== +REVIEW+ Image styles: float, thumbnail, and related 

For block images, you can use the float attribute (+float="left"+ or +float="right"+) or the position in the role (+role="left"+ or +role="right"+). 
In both cases, a margin is added above the image and ~10px between the image and text.

For inline images, you can use the position in the role (+role="left"+ or +role="right"+).
Margins are added above and below the image and ~10px between the image and text.

Styles to emulate the look of a thumbnail (+role="th"+ or +role="thumb"+) have also been included.

Here's an example of how to make an inline image look like a thumbnail and float to the right of the text:

 image:foo.png[role="related thumb right"] Here is the text that will be to the left.

The related role isn't technically required, but recommended for semantic reasons.

Here's an example of how to make a block image look like a thumbnail and float to the right of the next block (e.g., paragraph):

----
.An image title
image::foo.png[role="thumb right"]

Text in next paragraph.
----

In the example above, +float="right", role="thumb"+ would also work.

A margin attribute was not introduced because it mixes very specific presentation information with content, which AsciiDoc works hard to keep separated. 
The proper way to style an element is to assign it a role (or an extra role) and provide a stylesheet that contains styles for that role.*

If you want to customize the image styles, you can provide your own stylesheet additions (either by using your own stylesheet that builds on the default stylesheet or adding them in a docinfo file).

* The float attribute walks a fine line here.

WARNING: The shorthand syntax for a role (+.+) can not yet be used with image styles.

*TODO: The .related (.rel) attribute needs a definition and example.*

Resolves {issue-ref}/460[460]

=== +REVIEW+ +toc2+ (Table of Contents) position option

The +toc2+ attribute can be placed on the right side of your document.

*TODO: Example showing how you place it on the right*

Resolves {issue-ref}/467[467]

////
Add support for toc position top and bottom in the future.
////

// Check on this issue: list improvements (473)

=== Image URLs get rendered, not mangled

AsciiDoc couldn't decide if it wanted to support remote images (i.e., images with a URL target) or not.
While you've always been able to use a URL for block images, both AsciiDoc and Asciidoctor were ignoring inline images that have a URL target.

Even the block images would fall apart in AsciiDoc if you defined the +imagesdir+ attribute to set the location of your local images.
AsciiDoc was mangling the image URL in this case by blindly prefixing the URL with this path.
Doh!

Things were messy.
They aren't anymore.
You can now reference images served from any URL (e.g., your blog, an image hosting service, your docs server, etc.) and never have to worry about downloading the images and putting them somewhere locally.
Asciidoctor just gets it right.
We've also updated the AsciiDoc compatibility file so that AsciiDoc gets it right too.

Here are a few examples of images that have a URL target:

.Block image with a URL target
----
imagesdir: ./images

image::http://inkscape.org/doc/examples/tux.svg[Tux,250,350]
----

.Inline image with a URL target
----
imagesdir: ./images

You can find image:http://inkscape.org/doc/examples/tux.svg[Linux,25,35] everywhere these days.
----

NOTE: The value of +imagesdir+ is ignored when the image target is a URI.

If you want to avoid typing the URL prefix for every image, and all the images are located on the same server, you can use the +imagesdir+ attribute to set the base URL:

.Using a URL as the base URL for images
----
:imagesdir: http://inkscape.org/doc/examples

image::tux.svg[Tux,250,350]
----

This time, the +imagesdir+ _is_ used since the image target is not a URL (the +imagesdir+ just happens to be one).

_Resolves issue {issue-ref}/470[#470]._
// NOTE there's an open question pending at the end of this issue about adding an imagesurl attribute

// Have no idea what to do with this one

=== +REVIEW+ Optional argument added to AbstractNode.role? method that checks for the presence of a role name

Example:

[.build]
* one
* two
* three

The following call should return true.

 role? 'build'

Resolves {issue-ref}/474[474] 

////
TODO: How do I call for something in Asciidoctor? In what kind of situation would the above method and argument be used?

From issue, you also wrote: 

It might also be nice to add a roles method that returns the roles as an array, which is needed to implement this enhancement anyway.

TODO: Did you add this method? What's it called, where is it used?

TODO: In what Docs should this information be added to?
////

=== +REVIEW+ Style options shorthand

Normally, block options are specified using the +options+ attribute.
Asciidoctor 0.1.4 allows block options to be specified with the percent sign symbol (+%+).

Consider a table block with three options. 

.Traditional AsciiDoc syntax
----
[options="header,footer,autowidth"]
|===
| Cell A | Cell B
|===
----

Here's how the options are written using the shorthand notation (+%+).

.Shorthand Asciidoctor syntax
----
[%header%footer%autowidth]
|===
| Cell A | Cell B
|===
----

Let's consider the options when combined with other shorthand notations. 

.Traditional AsciiDoc block syntax
----
[horizontal, role="properties", options="step"]
property 1:: does stuff
property 2:: does different stuff
----

.Shorthand Asciidoctor block syntax
----
[horizontal.properties%step]
property 1:: does stuff
property 2:: does different stuff
----

Resolves {issue-ref}/481[481]

=== +REVIEW+ Docinfo option for footer

Docinfo files allow authors to include arbitrary content in the header of a rendered document (HTML or DocBook). 
Now, docinfo files can be used for including content in the footer.

The "footer docinfo" files are named with the suffix `-footer`. 
For example, `docinfo-footer.(html|xml)` or `docname-footer.(html|xml)`.

// TODO add that default footer text can be controlled using label attributes

Resolves {issue-ref}/486[486]

=== +REVIEW+ Attributes for handling missing and undefined references

By default, the original AsciiDoc processor drops a line if it contains a reference to a missing attribute.
A dropped line may not be what the user wants or expects. 
It's also frustrating since it may not be immediately apparent to the writer, editor, or other readers that a line is missing until a full read-through of the text is done.

Asciidoctor 0.1.4 introduces two attributes to alleviate this inconvenience: +attribute-missing+ and +attribute-undefined+.

+Attribute-missing+ has three ways to handle missing references:

* +skip+ - leave the reference in place (default)
* +drop+ - drop the reference, but not the line
* +drop-line+ - drop the line on which the reference occurs

Consider the following declaration:

----
 :attribute-missing: drop
----

This reads as:

 "When an attribute is missing, drop the reference to it."

+Attribute-undefined+ is used when an attribute is undefined (i.e., unassigned). 
Consider the following declaration:

----
{set:name!}
----

In this case, we never want the skip behavior, because this is a directive, not output. 

The possible values for +attribute-undefined+ are:

* +drop+ - substitute the directive with an empty string after processing it
* +drop-line+ - drop the line on which this directive (default)

*TODO: the sentence above doesn't make sense*

By default, this attribute is set to +drop-line+, which is standard AsciiDoc behavior.

Resolves {issue-ref}/495[495], {issue-ref}/523[523]

=== +REVIEW+ +!+ before an attribute name undefines the attribute

AsciiDoc uses the convention of a +!+ at the end of an attribute name to undefine the attribute. 

 :numbered!:

However, this may read as "numbered not". 
Now, the +!+ can also be placed at the beginning of the attribute name to undefine it.

 :!numbered:

This reads as "not numbered", which is more consistent with programming conventions.

When used on the commandline, the leading +!+ is misinterpretted by the shell as a command. 
However, this is easily solved by quoting (or escaping) the argument value. 

For example:

 -a '!numbered'

or

 -a \!numbered

Resolves {issue-ref}/498[498]

=== +REVIEW+ Ignore front matter used by static-site generators

// skip-front-matter attribute

Commonly used in static site generators, front matter typically starts on the first line of a file and is marked by a delimited block (+---+).
Asciidoctor 0.1.4 treats front matter as comment lines and ignores it. 

Example:

----
---
layout: default <1>
---
= Document Title

content
----
<1> The Asciidoctor processor will ignore this front matter.

Resolves {issue-ref}/502[502]

////
TODO: So what attribute name did you decide to use? How do you use it
TODO: Example code
Which docs should this be added to?

From issue:
We should probably have a means of enabling this feature, since it's distinctly non-standard. Perhaps we can name the attribute skip-front-matter.

Should we capture the front matter into the attribute front-matter? What about for include files?
   
I think that this attribute is really necessary to extend the use cases where AsciiDoc format can be used. For example you can bake all project documentation (Manual, Design, Requirements, ...) using Awestruct so all members of the team can check, but at the same time if you need to provide that documentation to any regulatory office then you can render it and submit it without any problem, simply skipping the Awestruct header part.
////

=== +REVIEW+ Strip HTML tags from doctitle when rendering HTML title element

AsciiDoc uses the document title (i.e., +doctitle+ attribute) to populate the HTML title element in the HTML backend. 
It also permits inline formatting in the +doctitle+; however, the HTML title element must be plain text. 
The HTML backend will strip HTML elements (but not the containing content) from the doctitle before inserting it into the HTML title element.

Example:

AsciiDoc document:

 = *Document* _Title_
 
As rendered currently:

 <title><strong>Document</strong> <em>Title</em></title>
 
Expected:

 <title>Document Title</title>
 
Note that a workaround is to define the title attribute on the document, which is used in place of the doctitle in the HTML title element.

Example:

----
= *Document* _Title_
:title: Document Title
----

The HTML 5.1 specification drafts state that the title element is require and it must not be empty. Therefore, I've introduced "Untitled" as the default value, retrieved from the untitled-label document attribute.

Resolves {issue-ref}/504[504]

Resolves #504 sanitize contents of HTML title element in html5 backend
- also use 'Untitled' for HTML title when doctitle is nil

// TODO: I'm not sure what exactly is being added here? What is the feature and syntax?

=== +REVIEW+ Updated ToC style in default stylesheet

The preamble +toc+ has been updated with a panel-like styling and placed in the default Asciidoctor stylesheet.

Here's a preview:

*TODO: image*

Resolves {issue-ref}/507[507]

=== +REVIEW+ Id and role shorthand on quoted text

The id (+#+) and role (+.+) shorthand can be used on quoted text blocks.

.Quoted text block with +id+ and +role+ assignments using traditional AsciiDoc syntax
----
[[free_the_world]][big goal]*free the world*
----

.Quoted text block with +id+ and +role+ assignments using Asciidoctor shorthand
----
[#free_the_world.big.goal]*free the world*
----

Resolves {issue-ref}/517[517]

////
TODO: Was the issue below addressed?

From Issue: The open question is where to put this shorthand in inline macros. Putting it within the square brackets already present makes the most sense, but the attribute position is not as clear cut as it was with delimited blocks. That may need to be addressed in a separate issue.
////

=== +REVIEW+ Awesome icons everywhere!

Asciidoctor 0.1.4 introduces an inline macro for inserting an icon at an arbitrary place in paragraph content. 

Here's an example that inserts a tags icon in front of a list of tag names:

 icon:tags[] ruby, docs

Here's how this example renders in the HTML backed when the +icons=font+ attribute is set:

```html
<div class="paragraph">
<p><i class="icon-tags"></i> ruby, docs, asciidoctor</p>
</div>
```

More importantly, here's how it _looks!_

icon:tags[] ruby, docs, asciidoctor

If you aren't using the font-based icons, Asciidoctor looks for the images on disk, in the +iconsdir+, naturally.
Here's how it renders in the HTML backend when the +icons+ attribute is not set or empty:

```html
<div class="paragraph">
<p><span class="image"><img src="./images/icons/tags.png" alt="tags"></span> ruby, docs, asciidoctor</p>
</div>
```

Here's how it renders in the DocBook backend, regardless of the +icons+ attribute value:

```xml
<inlinemediaobject>
  <imageobject>
    <imagedata fileref="./images/icons/tags.png"/>
  </imageobject>
  <textobject><phrase>tags</phrase></textobject>
</inlinemediaobject> ruby, docs, asciidoctor
```

// FIXME I think this section can be moved to the documentation. We can pull out a few highlights to showcase above, but that's it.
==== Relationship to the inline image macro

The inline icon macro is similar to the inline image macro with a few exceptions:

* If the +icons+ attribute has the value +font+, the macro will translate to a font-based icon in the HTML backend (e.g., +<i class="icon-tags"></i>+)
* If the +icons+ attribute does not have the value +font+, or the backend is DocBook, the macro will insert an image into the document that resolves to a file in the +iconsdir+ directory (e.g., +<img src="./images/icons/tags.png">+)

The file resolution strategy when using image-based icons is the same used to locate images for the admonition icons. The file extension is set using the +icontype+ attribute, which defaults to +png+.

==== Icon sets

At the moment, the font-based icon set is assumed to be http://fortawesome.github.io/Font-Awesome[Font Awesome]. You can see the possible icon name options on the http://fortawesome.github.io/Font-Awesome/icons[icons page] page. Support for other icon sets is being discussed in issue {issue-ref}/539[#539].

When you aren't using font-based icons, or you are using the DocBook backend, the icon set is only limited by which icons you have in your +iconsdir+ directory.

==== Customizing the icon

The icon macro has a few attributes that can be used to modify the size and orientation of the icon. At the moment, these are specific to Font Awesome and therefore only apply to HTML output when icon fonts are enabled.

* size (first positional attribute) - scales the icon; possible values: large, 2x, 4x
* rotate - rotates the icon: possible values: 90, 180, 270
* flip - flips the icon: possible values: horizontal, vertical

The first unnamed attribute is assumed to be the size. For instance, to make the icon twice the size as the default, simply add +2x+ inside the square brackets.

 icon:heart[2x]

This is equivalent to:

 icon:heart[size=2x]

The previous example emits the following HTML:

 <i class="icon-heart icon-2x"></i>

To rotate and flip the icon, specify these options using attributes:

 icon:shield[rotate=90, flip=vertical]

The previous example emits the following HTML:

 <i class="icon-shield icon-rotate-90 icon-flip-vertical"></i>

NOTE: This markup is subject to change. In particular, the +<i>+ element may be replaced with the +<span>+ element.

==== Additional metadata

Like an inline image, it's possible to add additional metadata to an inline icon.

Below are the possible attributes that apply to both font-based and image-based icons:

* link - The URI target used for the icon, which will be rendered as a link
* window - The target window of the link (when the +link+ attribute is specified) (HTML backend)

Here's an example of an icon rendered as a link:

 icon:download[link="http://rubygems.org/downloads/asciidoctor-0.1.3.gem"]

The previous example emits the following HTML:

 <a class="image" href="http://rubygems.org/downloads/asciidoctor-0.1.3.gem"><i class="icon-download"></i></a>

Below are the possible attributes that apply in the case that font-based icons are _not_ in use:

* alt - The alternate text on the +<img>+ tag (HTML backend) or text for +<inlinemediaobject>+ (DocBook backend)
* width - The width applied to the image
* height - The height applied to the image
* title - The title of the image displayed when the mouse hovers over it (HTML backend)
* role - The role applied to the element that surrounds the icon

Currently, the inline icon macro doesn't support any options to change it's physical position (such as alignment left or right).

Resolves {issue-ref}/529[529]

=== +REVIEW+ Associate multiple terms with a single labeled list item

Labeled lists now allow for multiple terms to be associated with a single definition. 

Resolves {issue-ref}/532[532]

=== +REVIEW+ Leading separator stripped if idprefix is empty

If the +idprefix+ attribute is empty, the leading separator will be stripped when a section title begins with a non-word character or entity.

Example:

----
:idprefix:

== & More
----

Generated id: more

Resolves {issue-ref}/551[551]

=== +REVIEW+ Printing warning and error messages

Asciidoctor has replaced +puts+ with +warn+.
+Warn+ directs error and warning messages to $stderr. 
This is important because it prevents the messages from being displayed in the rendered document when piped to another command.

The +warn+ method prints messages to $stderr, which can be disabled in the script or when Ruby is invoked by passing +-W0+. 
The +asciidoctor+ command does not yet have a command flag to disable these messages.

Resolves {issue-ref}/556[556]

== Compliance

=== +REVIEW+ AsciiDoc compatibility file updates

The following features have been added to the AsciiDoc compatibility file (compat/asciidoc.conf).
 
* Level 5 (Heading 6) section title
* Link attributes (+linkattrs+)

Resolves {issue-ref}/388[388], {issue-ref}/441[441]

////
=== Link attributes feature (+linkattrs+) added to AsciiDoc compatibility file

This feature allows attributes in a link macro to be used in the HTML 5 backend.

For example:

----
ifdef::linkattrs[]

[http-inlinemacro]
<a href="{name}:{target}"{role? class="{role}"}{window? target="{window}"}>{1={name}:{target}}</a>

endif::linkattrs[]
----

Resolves {issue-ref}/441[441]
////

=== +REVIEW+ Incrementing section numbers

AsciiDoc allows section numbering to be toggled on and off throughout a document using the attributes +:numbered:+ and +:numbered!:+, respectively.

For regions of the document where section numbering is turned off, the section numbering will not be incremented.

Given:

----
= Document Title

:numbered!:

== Colophon Section

== Another Colophon Section

== Last Colophon Section

:numbered:

== Section One

== Section Two

== Section Three
----

The sections will be numbered as follows:

----
Colophon Section

Another Colophon Section

Last Colophon Section

1. Section One

2. Section Two

3. Section Three
----

Asciidoctor will always curtail incrementing the section number in regions of the document where section numbers are off.

If +numbered+ is set on the commandline (or API), that overrides the value set in the document header, but it does not prevent the document from toggling the value for regions of the document.

If +numbered!+ is set on the commandline (or API), then the numbers are disabled regardless of toggling within the document.

Resolves {issue-ref}/393[393], {issue-ref}/341[341]

=== +REVIEW+ Substitute attributes in docinfo files

Attributes are substituted in docinfo files before including the content into the output.

Given docname-docinfo.xml:

----
<edition>{revnumber}</edition>
With the following document:

= Document Title
Author Name
v1.0, 2013-06-01
:doctype: book
:backend: docbook
:docinfo:
Then the output should be:

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
    "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<book lang="en">
  <bookinfo>
    <title>Document Title</title>
    <date>2013-06-01</date>
    <author>
      <firstname>Author</firstname>
      <surname>Name</surname>
    </author>
    <authorinitials>AN</authorinitials>
    <revhistory>
      <revision>
        <revnumber>1.0</revnumber>
        <date>2013-06-01</date>
        <authorinitials>AN</authorinitials>
      </revision>
    </revhistory>
<edition>1.0</edition>
  </bookinfo>
</book>
----

Resolves {issue-ref}/403[403]

// Not sure this example is complete or how to explain example.

=== +REVIEW+ Escaping the attributes that precede formatted text does not disable formatting

If the attributes that precede formatted text are escaped (using a leading backslash), the text will still be formatted and the attributes treated as plain text.

Given:

 Try to click a [disabled]\+button+.

The HTML output is:

 Try to click a [disabled]<code>button</code>.

Notice that text is still rendered as monospaced (inside a <code> element), but the attributes (which define the role) have been ignored and treated as plain text.

Resolves {issue-ref}/421[421]

=== +REVIEW+ Embed CSS by default, +copycss+ when +linkcss+ is set

In Asciidoctor 0.1.4, the standard stylesheet is automatically embedded.
By embedding the stylesheet by default, the user does not need to worry about linking to (+linkcss+) the stylesheet or copying (+copycss+) it to the output folder.
Additionally, when the user prefers to link to the stylesheet by setting +linkcss+, the stylesheet will be copied (via +copycss+) automatically to the output folder.

Resolves {issue-ref}/427[427], {issue-ref}/428[428]

=== +REVIEW+ TOC double numbering eliminated

The TOC in the HTML5 backend is now output as an unordered list instead of an ordered list. 
This eliminates the chance of the double numbering problem (native list numbering and section numbering), even in the absence of a stylesheet.
It also removes the need to use +type="none"+ on +<ol>+.

Resolves {issue-ref}/427[427], {issue-ref}/431[431], {issue-ref}/461[461]

=== +REVIEW+ Preprocessor directives on first line of a table cell

The first line of an AsciiDoc table cell is recognized as the beginning of a line, and thus preprocessor directives will be processed.

----
|===
a|include::chapter.ad[]
|===
----

Resolves {issue-ref}/453[453]

=== +REVIEW+ Percentage column widths

Instead of taking the percent widths verbatim (like AsciiDoc), Asciidoctor strips the % sign and calculates the percentage based on relative numbers. 
Otherwise, you can end up with percentages that don't add up to 100%, which is technically broken HTML.

Here are some examples:

----
Input: 10%,90%
Output:

<colgroup>
<col style="width:10%;">
<col style="width:90%;"> 
</colgroup>
----

----
Input: 10%,10%
Output:

<colgroup>
<col style="width:50%;">
<col style="width:50%;"> 
</colgroup>
----

Resolves {issue-ref}/465[465]

=== +REVIEW+ Correct list style value with role shorthand
 
When the role shorthand (+.+) is used over an ordered list, the list style value is now correctly applied.

Resolves {issue-ref}/472[472] 

=== +REVIEW+ Manpage metadata

// TODO mention the experimental manpage backend in the asciidoctor-backends repo

Asciidoctor parses the manpage metadata, including:

* mantitle
* manvolnum
* manname
* manpurpose

The +mantitle+ and +manvolum+ are parsed from the document title. 
The +manname+ and +manpurpose+ are taken from the first section of the document, which must be a level 1 section and have content in the format <manname> - <manpurpose>.

For example, the following input:

----
= asciidoctor(1)
:doctype: manpage

== NAME
asciidoctor - converts AsciiDoc source files...

== SYNOPSIS
*asciidoctor* ['OPTION']... 'FILE'...
----

Produces these variables:

mantitle: asciidoctor
manvolnum: 1
manname: asciidoctor
manpurpose: converts AsciiDoc source files...

// also mention that there is now a manpage backend available in the asciidoctor-backends

Resolves {issue-ref}/488[488]

=== +REVIEW+ Manpage header
 
Asciidoctor outputs the same HTML header for the manpage doctype as AsciiDoc.

Resolves {issue-ref}/489[489]

=== +REVIEW+ Comment lines and matching labeled list items (+//::+)

The labeled list item now ignores comment lines and allows section titles to be processed correctly.

Resolves {issue-ref}/524[524]

=== +REVIEW+ TOC and numbered attributes in DocBook backend

The `toc` and `numbered` attributes are enabled by default in the DocBook backend.

Resolves {issue-ref}/540[540]

== Fixes

=== +REVIEW+ Correctly calculates line length in Ruby 1.8

In Ruby 1.8.7, each unicode character is counted, whereas later Ruby versions see them as a single character. This patch corrects for how Ruby 1.8.7 claculates line lengths when they contain a non-ASCII (multi-byte) character. 

Resolves {issue-ref}/167[167]

=== +REVIEW+ Only split attribution for shorthand blockquotes on first comma

The attribution for the shorthand blockquotes introduced in Asciidoctor 0.1.3 now only splits on the first comma.

Given:

 -- Thomas Jefferson, Papers of Thomas Jefferson, Volume 11

Results in the following attributes:

 attribution: Thomas Jefferson
 citetitle: Papers of Thomas Jefferson, Volume 11

Resolves {issue-ref}/389[389]

=== +REVIEW+ Allow Java::JavaUtil::Map for attributes option type in load API

The type check on the attributes option in the Asciidoctor load API was too restrictive as it did not accommodate a Java Map (Java::JavaUtil::Map). 
This broke the Java integration in 0.1.3.

In Asciidoctor 0.1.4, the type check on the attributes option was relaxed in two ways:

. It checks if the type is a Java::JavaUtil::Map when the RUBY_ENGINE is jruby
. It allows any type that responds to "has_key?" as that's likely a Hash-like object

See asciidoctor/asciidoctor-java-integration#50 for further reference.

Resolves {issue-ref}/396[396]

////
TODO: Fix java link
TODO: What about the two notes in the commit?
Resolves #396 allow JRuby Map as attributes
- also allow something we can convert to a Hash
- fix missing argument to include macro callback in test
////

=== +REVIEW+ Write to specified outfile when the input is stdin

The Asciidoctor cli command does not write to the specified file if the input is stdin. 
Instead, the output is written to stdout.

Example:

 echo "content" | asciidoctor -o output.html -

The file output.html does not exist after running this command.

Resolves {issue-ref}/500[500]

// So was this fixed? What is the expect output now?

=== +REVIEW+ URLs in footnotes

Footnotes containing URLs are now parsed correctly and the corresponding CSS has been updated in the stylesheet factory.

Resolves {issue-ref}/506[506]

=== +REVIEW+ Lowercase attribute names passed to API

Attributes that contain upper case characters can now be resolved.

Resolves {issue-ref}/508[508]

=== +REVIEW+ Open blocks and paragraphs styled as comment are too greedy

Open blocks and paragraphs that have the "comment" style are consuming lines well beyond the terminator. Add tests for these scenarios and fix the parser to stop capturing lines at the proper termination of the block.

Examples:

Open block comment
```
[comment]
--
skip

this block
--

not this text
```

Paragraph comment
```
[comment]
skip
this paragraph

not this text
```

Paragraph comment adjacent to block
```
[comment]
skip
this paragraph
[example]
not this text
```

Resolves {issue-ref}/546[546]

== Docs

=== +REVIEW+ Unable to put Nexus style URLs #393 --> This information needs to go into the docs

=== +REVIEW+ Document tilt dependency in cli usage and manpage Resolves #433

Document in the cli usage and manpage that the tilt gem is required to use the -T flag.

Also, ensure that the tilt gem can be loaded and emit a failure message in the cli if it cannot be loaded.

=== +REVIEW+ Create a page that lists / recommends editors (#81)

People are often asking which editor they should use for AsciiDoc (phrased as "what's a good AsciiDoc editor?"). Of course, our stance is that you don't need a special editor. We can make that point, but also recommend editors that have good syntax highlighting and perhaps embedded preview.

We want to make sure to recommend open source options first, but I guess it would be biased if we didn't list non-open source editors that are know to be very good (such as Sublime).

=== +REVIEW+ Write documentation for how to create a custom backend (#80)

Write documentation for how to create a custom backend. Information to be covered includes:

What template languages can be used (answer: anything supported by Tilt)
The names of each template and how the file is named
What objects are available to the template
Brief documenation about the structure of an Asciidoctor document object model
Commonly used instance variables and methods in the template
Some started material can be found here:

asciidoctor/asciidoctor-backends#12





Brain Dump: AsciiDoctor, WordPress 3.5.2 - Enigmastation.com
Cleaning out a few cobwebs: Asciidoctor Asciidoctor is really nice to write in. Gedit's Asciidoctor syntax is a tiny (tiny) bit broken; \C++ should escape the entire  ...
http://www.google.com/url?sa=X&q=http://www.enigmastation.com/posts/brain-dump-asciidoctor-wordpress-3-5-2/&ct=ga&cad=CAcQAhgAIAEoBDABOAFA--azjgVIAVgAYgVlbi1VUw&cd=n1VQef2Hv7I&usg=AFQjCNGwbrHq9QBBNb3-aShJ06AkLGrWlg

Shell script to run the Asciidoctor Java build against the tip of Asciidoctor Ruby. First downloads and installs the unreleased version of Asciidoctor Ruby, then runs the Asciidoctor Java test suite against the unreleased version.

== Minor, may get cut

=== +REVIEW+ +showtitle+ is an alias for +notitle!+

The +notitle!+ attribute allows the document title to be included in the rendered document when the header and footer are disabled (i.e., embedded). 
However, the double negative is confusing for users. 
Now, the attribute +showtitle+ can be used instead of +notitle!+.

Resolves {issue-ref}/457[457]

////
Cuts:

=== Cache backend templates

*TODO: What is the benefit of caching?*

*TODO: Where should this be documented (technical?/API manual?*

*TODO: Example code showing how to explicitly disabled it or how a replacement cache can be passed in via the options.

*TODO: Was the option named +template_cache+?

If Asciidoctor is invoked multiple times within the same Ruby process using the same set of custom (Tilt-based) templates, those templates should not be loaded more than once.

This problem can be solved in two ways. 
In the absence of any configuration, the cache can be maintained internally. 
The cache should be partitioned such that the same template name in different backends should be separate keys.

It should also be possible to supply an instance of the cache as an option to the Asciidoctor API. 
That way, it's possible for the client application to control the cache (duration, size, etc) and flush it at will.

A proposed option name for the supplied cache is +template_cache+.

I've observed that Haml seems to have an internal cache of templates its already loaded, whereas Slim seems to read the same template each time it's requested. 
We can probably look at what Haml is doing and clone that. 
There is also a very primitive cache example in Tilt (TiltCache).

I think the global built-in cache should be enabled by default. 
It can either be explicitly disabled or a replacement cache can be passed in via the options.

Resolves {issue-ref}/438[438]

=== +html-pipeline+ source-highlighter

The source-highlighter option +html-pipeline+, which prepares source code listing blocks to be processed by +jch/html-pipeline+, is now available.

In particular, a source code listing should appear as:

 <pre lang="ruby"><code>require 'asciidoctor'
 puts Asciidoctor.render('http://asciidoctor.org[Asciidoctor]')</code></pre>

Resolves {issue-ref}/447[447]

// TODO: Is this a source code highlighter that is used like CodeRay? (called in attributes/blocks the same way?
// TODO: What the heck am I supposed to do/determine from the code snippet above?

=== +REVIEW+ Template engine option for the CLI

The template engine option in the API (i.e., +:template_engine+) is now mapped as an option in the CLI.

 --template-engine

or

 -E

This option is used for resolving the location of a collection of backend templates.
For example, if you execute:

 > asciidoctor -b html5 -T asciidoctor-backends -E slim
 
Asciidoctor will look for templates in the directory [file]_asciidoctor-backends/slim/html5_.

Resolves {issue-ref}/406[406]
////
